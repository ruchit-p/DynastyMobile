echo "🔍 Running pre-push checks (Web + Firebase only)..."
echo "📱 Mobile app checks are EXCLUDED from pre-push hooks"

# Run linting with auto-fix
# Note: This only checks apps/web/dynastyweb and apps/firebase/functions
# Mobile app (apps/mobile) is NOT included in these checks
echo "📝 Checking and fixing linting (Web + Firebase)..."

# Fix web linting
cd apps/web/dynastyweb && npx eslint --ext .js,.ts,.tsx . --fix
web_lint_exit_code=$?

# Fix firebase linting  
cd ../../.. && cd apps/firebase/functions && npx eslint --ext .js,.ts . --fix
firebase_lint_exit_code=$?

cd ../../..

if [ $web_lint_exit_code -ne 0 ] || [ $firebase_lint_exit_code -ne 0 ]; then
  echo "❌ Linting errors found that could not be auto-fixed. Push aborted."
  echo "💡 Check the output above for manual fixes needed"
  exit 1
fi

echo "✅ Linting checks passed (Web + Firebase only). Proceeding with push..."